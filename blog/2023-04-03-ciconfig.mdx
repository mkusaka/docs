---
title: "CircleCI設定の痛みをTypeScriptで解消するアイディア"
date: 2023-04-03
description: "CircleCI設定ファイルの編集やメンテナンスの悩みを解決するため、TypeScriptを活用する方法を紹介。"
categories: [ci]
tags: [typescript, circleci, yaml]
---

## tl;dr
- circleciのyamlを書く/メンテンするのは辛い
- javascirpt objectをjs-yamlでdumpするようにすればtypescirptの補完が受けられる
- typescirptの型生成の方法はいくつかありそうだが、現状仕様変更に追従するのが厳しそう
  - [JSON schemaから生成する方法](https://github.com/mkusaka/ciconfig/blob/main/types/circleci-config-types.ts) 
  - [chat GPTに書かせた例](https://www.typescriptlang.org/play#code/PTAEAsBdIBwZwFwgMYEsBOyA2BTNA6ZAewFtgATI5OYAJnwAZhiA7AM1QHMBXdAQ0ioiLALTocbHOJbIcwAMRw8g4QF5WHHvxUsAUKhaQpbPrNABhDNhzmAkueGbQAb12hQIULQA0Xxr6J0PwBGUABlHBxQSHAogG0AJRxuOANOC0cuAF0ACihYRBQrXAJiMkpqOkZgcRS0kQ0uYABKUArQNkDQPhZQIgA3KX7UHAB3PrYQ0ABrHABPOG7+vlQsPgAjXGiiUFSSGCxUNjnQOaJeUEJivFRmTM58OZIsDtWcX1qlXx7yUBg+fgkHBGdCoABeOF+ACsiOs4Pg3KBBuhUsIEF5QAAfPwMLEhADciM8AEFQCQ+DAJn10OsZvN4eFItFYqA4gB5GmgJKSaSyXL5eBIZjXUqkChUGj0JiBdYiAyQdBEFodLrkYErLDwxEyuAAfnRSWI6HIAB44Aq0r4OesACISAyoHQAPkJ7hJZIpVLK5JYv1mC3wjKiMXiSRSGy2DnYXC5EikOBkUQA4txUGr+dBBUVMCVUIQxRVJdVPvVGpxlZ0gmrIBqte5vT89Qa8IFTebQSxOL4HCQfeQ7RwWI6hCwXUSwKTyZSiJMcAAPPDcSBdf0MiLBlmJZJwCNRKNObnxxOgFNpnAZgpCtA5m758oSqpMEudhr3Cuq9WrOugeeL5co-VYyNNsLU7XwAFEF2QJdAgHB1nVdDwJw9adJhhWlV0DddmXiAApWFFkPXlzzyTNCmFG9RXvSopWAdC4BEc0cHgd8q0-TUEXcejAMNVszVArtQHw217SHBDx1ASdPRnUBRkCaY2CwIhxkwoMcNZAB1eTFOUwi42Ii8swo6wqPFGjqjk9AFKU0YaFaSs2nY79LOs3SeJbY1+I7QStKsnTRjgsSRzHABfXRdE8AVyOvEy8zKMyiyYMteAEEcxH0hNZAUHV0oAR1TcQGORVFRFoYIIonXoZUcwccEWPgUKpHBcCBQxFhiARTnOD0ThSYMdj2A4jhOM4LjLLCmRDVlrVAWxDEVQzopFOKCwfWiZTlealXsroej6ZFhjGKlqvDTgoh+H85z4fZcC1eVjFMKJrUC4dhBcCSpNQy6-xXekJo3UNt13DJo3SIjMuTVN01Iy9s1iu8EsfGpt1LN8drYmsv0477oP-JsgL49tLVASCfvQF7xLdZCpy9Ug+zpAM1Kmrdw02Pd7ljHkIZPKGSKiq9loRwskefThX1B1jHMxjjEQbX18d4zyibAjJex+CngsQ90aZk9CGbXSbN2EvSucTRaBcolbqMSuiCMYowWPRqXa2x7jm2ArzieEjXhDHKnJMamT-kBYEpH1-71LiAAFAFrtDoIwjmQw+Dnc24dzIW1uLFGXzLBRg7jkFGKTms51aJRkB0KkprDVJOxBpwKm4VrIBVDGXcRAugRBBWPJA7yrRpGOQ5BP2kPCcBAlbtU4GQUEYCrmSYlQRYZURGe59QBeR0A5XOEJMKKogMiLfh+Lhdo5LtDS8RTay+Q5fIBjxHyjA6pEYq0rKo-SUfmqDDqt0XYOB8rcxkkxeA3R6qNWXKAdYURfy40hKAAwQD0K+ATBGNIXVuDbFAJ8c6uw0hbD-mqQcr1eimEVHARYJBuBYEEAcKI9FAwADEugkECFEAwlZyRVyUADVktdgb7hjODY8p5ob83Trec+Wcnw5zFnnZoCJ7roBMGYHsfYfa9FcP7T6VIu7x3DkzTcw9C5h0TsnVOMMjIxQznI8yCi6i5zfPIIxRc4AlxTuXZQI5q4slrtg0R6Qm4tzbs7LGndY7dykL3D2e9ux0x+OY2J6Ax4QMQO4MIDs4hZC1mAMIk90DTzqpvbeb0l7gBXqAR+68ynzx0LvASB9wqRRPjI0yF9qhX1SsIdKd85DyEQTBFEeUCrv0-v07+JJegjP-P-FggCpoJmGIqFg4TUGjGqcgcA6lMlUganrUYqwXjwPwdwFg3wsA2WwaNPBBCgF104FseZH5yFVyoUQGhZJ6GMK2Cw0A7CgicPECg9ggQ+H+IEZHYRbMG5iIyhI3madjIONWk45GLilFowRJAOYMAoik1xrBUSFDQCqFADaKgsx0DEtGXiAAsqYapSz6ULOxMy5AbIwjsq6NiDSBhKC2T5egQkR9pFotkRim2vSdADKPPfCotKj4ABUWTUuQLSnGDK+A3N0jgvBfUqU0rDrA9AlycFBEBeBFloA9bkhOOAPggxfkMK3lsTV2rUDkjOgyYkNzanCExkslEFzeioKmjuIEoAlmQBct0X0tS9rekuagZAAgognJiD+O1RAQzoEDOqqIHAUStx9XwM6KD2oshgKCck6ATisBDWHCtVaLo1L6r8ByeqXiP0WOsE4ZC+B-MDMScg5AKF6qDcnABYaTmBvORa3o2a9krPmgSog8p9pSFBBOhMeD-jGrgDsDqrcQwnABOdZYqxgawKUOgYYZgX7cDqpARYbBFQkHUnWitjaZ0tsLfoQwD0zBeqkKK967hlVSHROB9AthfU4DyQU0AxbZLyTSAAfUneISugQTj+h6nAqIXa8FwEJWgY4QDcPKAIxEo5sJAwAE1uqOtAMa5eiwiP3so8NGjb98P-p7fa2E4Kf31oBE24NKxQ1FpZC5bDtGhMnBqds+MVrdgO0WMu7GinOw4cE-+OYzTvKIVWRgYQLd3IJIEr4PeY9tbSUmB4sOqlsLM1ScYqxpdUX2OldbEWijxaaHzjE+OxdrG+Mrv4qpUQgn1xCW0KgzcEytwctWDu7hXMAXdoTOzJMoKjK86PVDRSp6OVno02LkwuM6v-PUqrW8mnoj3q0iVHSpVdPkXcUGKV5W30VUM8kuyAFqpZFy1lCCisLN7Qa+55rLWjWtQRcTDU1STozUYcgGCYCxCBPwF4AA1RlslHRrpZJ0fVJz64UZuBwLbI4sm0CROYKOABVOAvgADs+AACsSYABCXJiSMt8MEBgDAgdUnNIEStOAWPdQzb0aCsOSDgkESduBvVnkSZwCIdYqYGEoKQ38RUwwNvY4sNcOw1IONKE08pFHKRlzfrbQj4DIINFREmwAyDeiPSjaWeiAX7h2embSIhEKiF9OcEM3h4zEvOzmZYGsqzaWbP5YHlp7yjnqbOb+OFkEJiPNmKN5Y7xNjJX+e65i0WIWmjuPN+gSLpdouL1q4ExRCLQkpfCRlpy2McvxK18TUVJWpB64nhVje1XKme5qW89AjXyktZ15L3Qh92mwy61bRGl97j9Zvki++I3vnjaiCNnl9XdrXcWAtnYhPVi-GW4L6vdaiBQmUAyW1uzRO0hqcuvolCOiFT2Vjs91bKsKiIHMZBnV12-Di-31RIH1GPVAFynl-PERl6yaL0Ac5iBqlay0xE0vESy-l3RxtSv96Igs+s6zeWlYFYc6hgxQdncm8NvECPCdLc-NBZHEbZ7c84ncR4pBXcfFgEYt491IEt0gkswk0sIlMsolstncQ9X9tdw9nco9ysSlKtU8atmRE8ZtAgU848WA792ts87FgCZUkY5Vi9BkFAbthU4AK9QBBVfQDUk9ug69DVYFjVGV01qEZxW5eDODGRH0w5aAGBggABOB5Jbc4IIaQg1FhTnUDKITQkVCgoIAXDg3SEXREMXJDU-Mzc-GXTDAzZTRXKwjPdwR-dXQwTXHA4md-D6QOFzb-dzX-Vkf-cIQA2xJaS2TOO3YLcAnLaAsuWAj3HCRAn3ZLaCf3D8aWLUYPDw-uMPQw--McTwQg0pJrCpKqBPRYJPXQWPZrHeJw5XTPNpMAa3RgwLAvPra+fpQbYiBQeiH+fvKfBqYgG5PxeAzJQMXvPZB1FnRybAK9RNGvIISfRPc7MOGDdAXwEbKbXwEw2yAIEFUwb5eTZhWEAAckWAOXmKH1QQameS2DTVblXXUlcI2VQLuyoxGHIEDGNm6DBTIQAV+FQVb3GieBeA4C2AunmLI1QVYChEuTgJXXOwwz8hsjujX25yElhB0XeiT0AlFR0UJEyXRByWYhQ24KvwcPoyI3Y3OTI143u0vTaCM3oxE3QkR1wXY042qW43mHIz42o3W2ZOE12gGMjVrUk3-WbVkykGOOROmCUyFNU0WHUzBVbwOV010ApMVNoN0BeOfwJk8JVm8Kcy+hyx-0EWCJ8xTgSNIJrm92QL91QID0yIRGyJf1yJVmEgKMJCKOKRKJIPgLq3QmqIaVqOEB1Kz2aM6xtzz26SSkL06NEG6IhnYO0lRKPl8lclsl+NIyUF+FgUCF2TfW0BOLhCp3+KHHrgakOHNCpHokTXzNiAwHDWpDVELR4LTINXmIrOQSBPUJnU0EeGeFeAhKTShLzPE1hPhKrieO0LUQxMzP8mxNcBNLrLEwCMER+PETMGdI7nonREXJsmEjJItE4DOlyzQ1BDPKkB0TJNXK-0gKCA3PUktMtxtMDK92xRSJQMMDQMD10DdINI9J8k7NGG9KPmKOIOoICTU1ApDNKLTza0aN0HxUJXCAdgpURGxGcHDQNEuRJMpDCncGwtqViC1XOEgHRHMDIumAooItACIrxBwqUEgG4BgCw3EE4SMBw1NXQGJOBDYqSC4pwHg3osYpIp3EGCwwzSLOJJdRsBZRwDEqwpcHwTfS4WksUubFh3EHMEUuUuItUrVAOFnzg2YiUjmAMqYu6AnSwxoXACw1XHRHHXIDCDCAAAkABpekKykigQGsXZLDFyCjR6Zy6AFlTMkK2QXy1SwlFEFeSALDZcIK+SKKnAdEKOOJBK1VIgSK-4aKjC8S1S9TFgKi4QSdHQPVGKnCy5W6LJKMCqkcKqwqlSnCx+eo9IIqpCjrHPGMyI2VBMvpJMkvIZZdHQ9fMwBIfCjCgXFgOOHU+sZJX0DqxCOAWIG5Ban8VXSzV49w90z2I0gSMedYUwaYTgRUS5cgQCdYIgIgXAHoRCFgIgLDCimAJcJKn1HACiiMpo4+Xq1o-PHpQagbEahQIs8ipccajE6ivAWipceigXf4GIH6o+fANG0AHIQANblAA7BnQuYlAEABKGQAZ4ZAB+hkAB+GQAVYZAByhjJsAE6GZoX6loiIkA5g4G1gobBQdYqGjfeDRDeHKDEneHFaxEEdZGsw9wdwPqdAOaoEYWiWw3GhSycgOWhixCPgWyLDUW8AQCA-dWuATW5AWQGhRy+YLDNMFW9wPWuyvAcQRK0wI2-W-0FWi-SMv6hg5mpg9ozQIvLo0G+QFyfyLg1CvQ0C4SClAW9CFW8EnuQCVhVYHuAkxEF9N+fGPeMkxakDOcSATa4OwCU4ikDvZYLAU4g+cVeg8Is+T2oGjooahVHo+QU8887mswVVK8885cxEWeWIcgehdKgW+sdZC2kcnudEOOhhOJRO9wF2xm6MgGuMrFZ5B3csCAixF3LxaxZup6Ieb-AXYO9Ec4gSU4vEU4+6c8o+7EU4m6u6nAHoc+0AU4hMZuO+h+ww5+zJEu+pEwP5QCHoOYFXZuH+lgOYdOqCsMmg4Ww+ecjfLRFJb-ecIweWUAa0YI5wMKKBswPAx8y6BBp+JB7erB1BzezE9YYI+BhMXB5BnetB9EjfQ85SUhrO8hxYShgh12wAEBU8bKRibybqa6bsbAAs7UAEr-QAewZABABksBvFp2xtpsADGGQAYYZAB1hkACuGCmwAQoZAAbhiJtpsAAh-pmyuto6u72xMuulMxQUYlgVQZMxMQASH-AAkhkACHlQAc0dAB1BkADMGQAeQZAADBkAFUGQAEQZAAgBl+rRsDByEAAlFQAaC9sbABmhjJsAEmGQAawZAAs33cYZp6vdv0cBvjJrpBrYLMdYvYs4vzRwB4q1SkCIYiHyaEqKdEpmsRCmXAfTwaOg14qwzWDn3QE0qF04GutuvupYDoKjP+o9oMayaMdrqsfvkkuKZktiHKfkr0qLIRsRCdsafv0wJiCyTTvyUv1iAaaQtdr0fRRGd6zGZyY5vkEKn-GmcUqIaSB0oUsWdqfcCctWZAZlpwE2pKpRvLtPiOcyZOa4B9uGtyeMosqIbtBMssqedjXmpVvatWdWvWqwE2r1I132sSVWeOtOvOvOF9B6evoesRCepeqXDesSsECBG+ogZnqGYyfnpYN9tyb4FsvspNoWCIZcrcq8p8uhcHHPN-Tag6rJIOdnuGf+YZeBfOf8pZRSqsjSo5fCt2TyseiWctsooReQp+c6VjJ6wlZMcTHziyvNCSueuCvypwCIcyvivNByuVYKvxoF0VHzRVqRvAE2YEmFZpfSb+fpbZsZfOZKqIYaqnSwFVa02YiyQIpAdYEarRA1ZFdpZ9d1b9clfrujriSIbHoTrJSrgF3WH4BkFiHxgP2ECwBMw6rxC2cQjF04CevEDv0rY9e2ansQhrE4GLfMOHzLYbexCrc7a4DrY+Yrd7abalwGdAA4fou4cppptpoEZEfEZp1sFAGkfkeUbUc0Z0cOYC3FZTf1cmfMcsZGrsacbca8b8cCaAA )

CircleCIの設定ファイルcircle.ymlをメンテナンスすることは、往々にして難しいです。YAMLの書式に苦戦したり、JSON Schemaによる補完が十分ではない場合があります。この記事では、TypeScriptを使ってCircleCI設定の問題を解決する方法を紹介します。

## YAMLの悩み
YAMLを直接書くことは煩雑で、アンカーを使って回避する方法も癖があります。また、JSON Schemaによる補完はある程度効果があるものの、十分強力ではないため、困難な状況がしばしば発生します。

## circleci-config-sdk-tsの限界
[circleci-config-sdk-ts](https://github.com/CircleCI-Public/circleci-config-sdk-ts)は、CircleCIの設定を扱うための公式のライブラリですが、宣言的ではないため、思ったように書くことができません。

## TypeScriptで解決
TypeScriptを使って以下の手順で問題を解決できそうです。

1. TypeScript用の型を作成する
1. 型に合致するJavaScriptオブジェクトを作成する
1. js-yamlでJavaScriptオブジェクトをYAMLに変換する
1. TypeScript用の型を作成する方法
1. 型を作成するには、以下の方法が考えられます。

以下で実際に型を生成するアイディアをまとめます

## JSON Schemaから生成する方法
JSON Schemaからtypescirptの型を生成するパッケージがあるため、それもとに生成することができます。

https://github.com/mkusaka/ciconfig

## Chat GPTにconfig referenceから生成させる方法
[config reference](https://circleci.com/docs/configuration-reference/)を読ませて型を生成させる事もできます。


実際に生成させてみましたが、ある程度使えそうなものを出すことができました

[出力例](https://www.typescriptlang.org/play#code/PTAEAsBdIBwZwFwgMYEsBOyA2BTNA6ZAewFtgATI5OYAJnwAZhiA7AM1QHMBXdAQ0ioiLALTocbHOJbIcwAMRw8g4QF5WHHvxUsAUKhaQpbPrNABhDNhzmAkueGbQAb12hQIULQA0Xxr6J0PwBGUABlHBxQSHAogG0AJRxuOANOC0cuAF0ACihYRBQrXAJiMkpqOkZgcRS0kQ0uYABKUArQNkDQPhZQIgA3KX7UHAB3PrYQ0ABrHABPOG7+vlQsPgAjXGiiUFSSGCxUNjnQOaJeUEJivFRmTM58OZIsDtWcX1qlXx7yUBg+fgkHBGdCoABeOF+ACsiOs4Pg3KBBuhUsIEF5QAAfPwMLEhADciM8AEFQCQ+DAJn10OsZvN4eFItFYqA4gB5GmgJKSaSyXL5eBIZjXUqkChUGj0JiBdYiAyQdBEFodLrkYErLDwxEyuAAfnRSWI6HIAB44Aq0r4OesACISAyoHQAPkJ7hJZIpVLK5JYv1mC3wjKiMXiSRSGy2DnYXC5EikOBkUQA4txUGr+dBBUVMCVUIQxRVJdVPvVGpxlZ0gmrIBqte5vT89Qa8IFTebQSxOL4HCQfeQ7RwWI6hCwXUSwKTyZSiJMcAAPPDcSBdf0MiLBlmJZJwCNRKNObnxxOgFNpnAZgpCtA5m758oSqpMEudhr3Cuq9WrOugeeL5co-VYyNNsLU7XwAFEF2QJdAgHB1nVdDwJw9adJhhWlV0DddmXiAApWFFkPXlzzyTNCmFG9RXvSopWAdC4BEc0cHgd8q0-TUEXcejAMNVszVArtQHw217SHBDx1ASdPRnUBRkCaY2CwIhxkwoMcNZAB1eTFOUwi42Ii8swo6wqPFGjqjk9AFKU0YaFaSs2nY79LOs3SeJbY1+I7QStKsnTRjgsSRzHABfXRdE8AVyOvEy8zKMyiyYMteAEEcxH0hNZAUHV0oAR1TcQGORVFRFoYIIonXoZUcwccEWPgUKpHBcCBQxFhiARTnOD0ThSYMdj2A4jhOM4LjLLCmRDVlrVAWxDEVQzopFOKCwfWiZTlealXsroej6ZFhjGKlqvDTgoh+H85z4fZcC1eVjFMKJrUC4dhBcCSpNQy6-xXekJo3UNt13DJo3SIjMuTVN01Iy9s1iu8EsfGpt1LN8drYmsv0477oP-JsgL49tLVASCfvQF7xLdZCpy9Ug+zpAM1Kmrdw02Pd7ljHkIZPKGSKiq9loRwskefThX1B1jHMxjjEQbX18d4zyibAjJex+CngsQ90aZk9CGbXSbN2EvSucTRaBcolbqMSuiCMYowWPRqXa2x7jm2ArzieEjXhDHKnJMamT-kBYEpH1-71LiAAFAFrtDoIwjmQw+Dnc24dzIW1uLFGXzLBRg7jkFGKTms51aJRkB0KkprDVJOxBpwKm4VrIBVDGXcRAugRBBWPJA7yrRpGOQ5BP2kPCcBAlbtU4GQUEYCrmSYlQRYZURGe59QBeR0A5XOEJMKKogMiLfh+Lhdo5LtDS8RTay+Q5fIBjxHyjA6pEYq0rKo-SUfmqDDqt0XYOB8rcxkkxeA3R6qNWXKAdYURfy40hKAAwQD0K+ATBGNIXVuDbFAJ8c6uw0hbD-mqQcr1eimEVHARYJBuBYEEAcKI9FAwADEugkECFEAwlZyRVyUADVktdgb7hjODY8p5ob83Trec+Wcnw5zFnnZoCJ7roBMGYHsfYfa9FcP7T6VIu7x3DkzTcw9C5h0TsnVOMMjIxQznI8yCi6i5zfPIIxRc4AlxTuXZQI5q4slrtg0R6Qm4tzbs7LGndY7dykL3D2e9ux0x+OY2J6Ax4QMQO4MIDs4hZC1mAMIk90DTzqpvbeb0l7gBXqAR+68ynzx0LvASB9wqRRPjI0yF9qhX1SsIdKd85DyEQTBFEeUCrv0-v07+JJegjP-P-FggCpoJmGIqFg4TUGjGqcgcA6lMlUganrUYqwXjwPwdwFg3wsA2WwaNPBBCgF104FseZH5yFVyoUQGhZJ6GMK2Cw0A7CgicPECg9ggQ+H+IEZHYRbMG5iIyhI3madjIONWk45GLilFowRJAOYMAoik1xrBUSFDQCqFADaKgsx0DEtGXiAAsqYapSz6ULOxMy5AbIwjsq6NiDSBhKC2T5egQkR9pFotkRim2vSdADKPPfCotKj4ABUWTUuQLSnGDK+A3N0jgvBfUqU0rDrA9AlycFBEBeBFloA9bkhOOAPggxfkMK3lsTV2rUDkjOgyYkNzanCExkslEFzeioKmjuIEoAlmQBct0X0tS9rekuagZAAgognJiD+O1RAQzoEDOqqIHAUStx9XwM6KD2oshgKCck6ATisBDWHCtVaLo1L6r8ByeqXiP0WOsE4ZC+B-MDMScg5AKF6qDcnABYaTmBvORa3o2a9krPmgSog8p9pSFBBOhMeD-jGrgDsDqrcQwnABOdZYqxgawKUOgYYZgX7cDqpARYbBFQkHUnWitjaZ0tsLfoQwD0zBeqkKK967hlVSHROB9AthfU4DyQU0AxbZLyTSAAfUneISugQTj+h6nAqIXa8FwEJWgY4QDcPKAIxEo5sJAwAE1uqOtAMa5eiwiP3so8NGjb98P-p7fa2E4Kf31oBE24NKxQ1FpZC5bDtGhMnBqds+MVrdgO0WMu7GinOw4cE-+OYzTvKIVWRgYQLd3IJIEr4PeY9tbSUmB4sOqlsLM1ScYqxpdUX2OldbEWijxaaHzjE+OxdrG+Mrv4qpUQgn1xCW0KgzcEytwctWDu7hXMAXdoTOzJMoKjK86PVDRSp6OVno02LkwuM6v-PUqrW8mnoj3q0iVHSpVdPkXcUGKV5W30VUM8kuyAFqpZFy1lCCisLN7Qa+55rLWjWtQRcTDU1STozUYcgGCYCxCBPwF4AA1RlslHRrpZJ0fVJz64UZuBwLbI4sm0CROYKOABVOAvgADs+AACsSYABCXJiSMt8MEBgDAgdUnNIEStOAWPdQzb0aCsOSDgkESduBvVnkSZwCIdYqYGEoKQ38RUwwNvY4sNcOw1IONKE08pFHKRlzfrbQj4DIINFREmwAyDeiPSjaWeiAX7h2embSIhEKiF9OcEM3h4zEvOzmZYGsqzaWbP5YHlp7yjnqbOb+OFkEJiPNmKN5Y7xNjJX+e65i0WIWmjuPN+gSLpdouL1q4ExRCLQkpfCRlpy2McvxK18TUVJWpB64nhVje1XKme5qW89AjXyktZ15L3Qh92mwy61bRGl97j9Zvki++I3vnjaiCNnl9XdrXcWAtnYhPVi-GW4L6vdaiBQmUAyW1uzRO0hqcuvolCOiFT2Vjs91bKsKiIHMZBnV12-Di-31RIH1GPVAFynl-PERl6yaL0Ac5iBqlay0xE0vESy-l3RxtSv96Igs+s6zeWlYFYc6hgxQdncm8NvECPCdLc-NBZHEbZ7c84ncR4pBXcfFgEYt491IEt0gkswk0sIlMsolstncQ9X9tdw9nco9ysSlKtU8atmRE8ZtAgU848WA792ts87FgCZUkY5Vi9BkFAbthU4AK9QBBVfQDUk9ug69DVYFjVGV01qEZxW5eDODGRH0w5aAGBggABOB5Jbc4IIaQg1FhTnUDKITQkVCgoIAXDg3SEXREMXJDU-Mzc-GXTDAzZTRXKwjPdwR-dXQwTXHA4md-D6QOFzb-dzX-Vkf-cIQA2xJaS2TOO3YLcAnLaAsuWAj3HCRAn3ZLaCf3D8aWLUYPDw-uMPQw--McTwQg0pJrCpKqBPRYJPXQWPZrHeJw5XTPNpMAa3RgwLAvPra+fpQbYiBQeiH+fvKfBqYgG5PxeAzJQMXvPZB1FnRybAK9RNGvIISfRPc7MOGDdAXwEbKbXwEw2yAIEFUwb5eTZhWEAAckWAOXmKH1QQameS2DTVblXXUlcI2VQLuyoxGHIEDGNm6DBTIQAV+FQVb3GieBeA4C2AunmLI1QVYChEuTgJXXOwwz8hsjujX25yElhB0XeiT0AlFR0UJEyXRByWYhQ24KvwcPoyI3Y3OTI143u0vTaCM3oxE3QkR1wXY042qW43mHIz42o3W2ZOE12gGMjVrUk3-WbVkykGOOROmCUyFNU0WHUzBVbwOV010ApMVNoN0BeOfwJk8JVm8Kcy+hyx-0EWCJ8xTgSNIJrm92QL91QID0yIRGyJf1yJVmEgKMJCKOKRKJIPgLq3QmqIaVqOEB1Kz2aM6xtzz26SSkL06NEG6IhnYO0lRKPl8lclsl+NIyUF+FgUCF2TfW0BOLhCp3+KHHrgakOHNCpHokTXzNiAwHDWpDVELR4LTINXmIrOQSBPUJnU0EeGeFeAhKTShLzPE1hPhKrieO0LUQxMzP8mxNcBNLrLEwCMER+PETMGdI7nonREXJsmEjJItE4DOlyzQ1BDPKkB0TJNXK-0gKCA3PUktMtxtMDK92xRSJQMMDQMD10DdINI9J8k7NGG9KPmKOIOoICTU1ApDNKLTza0aN0HxUJXCAdgpURGxGcHDQNEuRJMpDCncGwtqViC1XOEgHRHMDIumAooItACIrxBwqUEgG4BgCw3EE4SMBw1NXQGJOBDYqSC4pwHg3osYpIp3EGCwwzSLOJJdRsBZRwDEqwpcHwTfS4WksUubFh3EHMEUuUuItUrVAOFnzg2YiUjmAMqYu6AnSwxoXACw1XHRHHXIDCDCAAAkABpekKykigQGsXZLDFyCjR6Zy6AFlTMkK2QXy1SwlFEFeSALDZcIK+SKKnAdEKOOJBK1VIgSK-4aKjC8S1S9TFgKi4QSdHQPVGKnCy5W6LJKMCqkcKqwqlSnCx+eo9IIqpCjrHPGMyI2VBMvpJMkvIZZdHQ9fMwBIfCjCgXFgOOHU+sZJX0DqxCOAWIG5Ban8VXSzV49w90z2I0gSMedYUwaYTgRUS5cgQCdYIgIgXAHoRCFgIgLDCimAJcJKn1HACiiMpo4+Xq1o-PHpQagbEahQIs8ipccajE6ivAWipceigXf4GIH6o+fANG0AHIQANblAA7BnQuYlAEABKGQAZ4ZAB+hkAB+GQAVYZAByhjJsAE6GZoX6loiIkA5g4G1gobBQdYqGjfeDRDeHKDEneHFaxEEdZGsw9wdwPqdAOaoEYWiWw3GhSycgOWhixCPgWyLDUW8AQCA-dWuATW5AWQGhRy+YLDNMFW9wPWuyvAcQRK0wI2-W-0FWi-SMv6hg5mpg9ozQIvLo0G+QFyfyLg1CvQ0C4SClAW9CFW8EnuQCVhVYHuAkxEF9N+fGPeMkxakDOcSATa4OwCU4ikDvZYLAU4g+cVeg8Is+T2oGjooahVHo+QU8887mswVVK8885cxEWeWIcgehdKgW+sdZC2kcnudEOOhhOJRO9wF2xm6MgGuMrFZ5B3csCAixF3LxaxZup6Ieb-AXYO9Ec4gSU4vEU4+6c8o+7EU4m6u6nAHoc+0AU4hMZuO+h+ww5+zJEu+pEwP5QCHoOYFXZuH+lgOYdOqCsMmg4Ww+ecjfLRFJb-ecIweWUAa0YI5wMKKBswPAx8y6BBp+JB7erB1BzezE9YYI+BhMXB5BnetB9EjfQ85SUhrO8hxYShgh12wAEBU8bKRibybqa6bsbAAs7UAEr-QAewZABABksBvFp2xtpsADGGQAYYZAB1hkACuGCmwAQoZAAbhiJtpsAAh-pmyuto6u72xMuulMxQUYlgVQZMxMQASH-AAkhkACHlQAc0dAB1BkADMGQAeQZAADBkAFUGQAEQZAAgBl+rRsDByEAAlFQAaC9sbABmhjJsAEmGQAawZAAs33cYZp6vdv0cBvjJrpBrYLMdYvYs4vzRwB4q1SkCIYiHyaEqKdEpmsRCmXAfTwaOg14qwzWDn3QE0qF04GutuvupYDoKjP+o9oMayaMdrqsfvkkuKZktiHKfkr0qLIRsRCdsafv0wJiCyTTvyUv1iAaaQtdr0fRRGd6zGZyY5vkEKn-GmcUqIaSB0oUsWdqfcCctWZAZlpwE2pKpRvLtPiOcyZOa4B9uGtyeMosqIbtBMssqedjXmpVvatWdWvWqwE2r1I132sSVWeOtOvOvOF9B6evoesRCepeqXDesSsECBG+ogZnqGYyfnpYN9tyb4FsvspNoWCIZcrcq8p8uhcHHPN-Tag6rJIOdnuGf+YZeBfOf8pZRSqsjSo5fCt2TyseiWctsooReQp+c6VjJ6wlZMcTHziyvNCSueuCvypwCIcyvivNByuVYKvxoF0VHzRVqRvAE2YEmFZpfSb+fpbZsZfOZKqIYaqnSwFVa02YiyQIpAdYEarRA1ZFdpZ9d1b9clfrujriSIbHoTrJSrgF3WH4BkFiHxgP2ECwBMw6rxC2cQjF04CevEDv0rY9e2ansQhrE4GLfMOHzLYbexCrc7a4DrY+Yrd7abalwGdAA4fou4cppptpoEZEfEZp1sFAGkfkeUbUc0Z0cOYC3FZTf1cmfMcsZGrsacbca8b8cCaAA )

## さらなる改善
今後の展望として、以下の改善が考えられます。

- Zodスキーマによる検証を追加
  - TypeScriptでは、min/max/regex/defaultなどの検証ができないため、Zodスキーマに変換したい（現状では適切な変換ができていない）
- デフォルトの設定を自動生成させるようにしたい
- GitHub Workflow/GitHub Actionsでも同様のことができるはず
  - [actionlint](https://github.com/rhysd/actionlint)のように、GitHub Actionsの独自構文内の諸々にも対応できると良いでしょう
  - 以上で、CircleCI設定ファイルの書き方やメンテナンスが、TypeScriptを利用することでより容易になります。
  
今回紹介した手法を活用することで、CircleCIの設定ファイルの管理がスムーズになり、エラーや誤りを減らすことが期待できます。

## 補足
以上の文章は適当にtl;drを作った上でchat GPTにだいたい書いてもらいました。いい感じの文章が出てきたので、ソレに適切にリファレンスを追加するだけで完了したので楽でした。
